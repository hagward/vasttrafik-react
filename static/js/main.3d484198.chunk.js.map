{"version":3,"sources":["components/TripDetails.module.css","components/TripOverview.module.css","components/SearchBar.module.css","components/App.module.css","components/LocationSearchInput.module.css","components/DatetimeInput.module.css","components/Input.module.css","components/LocationInput.module.css","components/SearchResult.module.css","components/LocationSearch.module.css","components/Location.module.css","components/LocationList.module.css","components/LocationListItem.module.css","components/TripList.module.css","components/TripListItem.module.css","api.ts","Auth.ts","hooks.ts","settings.ts","util.ts","components/Input.tsx","components/DatetimeInput.tsx","components/Location.tsx","MruCache.ts","components/LocationListItem.tsx","components/LocationList.tsx","components/LocationSearchInput.tsx","components/LocationSearch.tsx","components/Modal.tsx","components/LocationInput.tsx","components/SearchBar.tsx","components/TripDetails.tsx","components/TripOverview.tsx","components/TripListItem.tsx","components/TripList.tsx","components/SearchResult.tsx","components/App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","searchTrip","token","origin","dest","date","a","async","dateString","dayjs","format","timeString","url","getLocationParameter","encodeURIComponent","fetch","headers","Headers","Authorization","method","response","json","inputName","location","id","lat","lon","name","Auth","key","secret","this","expiryDate","Promise","resolve","reject","storedToken","getStoredToken","Date","now","signIn","then","Number","expires_in","access_token","storeToken","localStorage","getItem","btoa","body","scope","generateScope","setItem","Math","random","toString","slice","String","useLocalStorage","initialValue","useState","window","JSON","parse","item","setInnerValue","value","stringify","list","object","Array","isArray","padNumber","n","Input","props","className","styles","wrapper","inputIcon","icon","input","DatetimeInput","onChange","onNowButtonClick","faCalendarAlt","type","event","target","toDate","nowOverlay","nowButton","onClick","Location","split","station","address","MruCache","limit","items","mru","removeExistingItem","unshift","ensureLengthWithinLimit","setMostRecentlyUsed","searchString","find","toLowerCase","startsWith","existingIndex","findIndex","existingItem","splice","length","LocationListItem","stopPropagation","LocationList","locations","onSelect","map","LocationSearchInput","onCancel","faMapMarkerAlt","placeholder","ref","setTimeout","focus","cancelButton","LocationSearch","recentLocations","getMostRecentlyUsed","locationState","setLocationState","searchValue","setSearchValue","quickLocation","setQuickLocation","debouncedSearchValue","delay","debouncedValue","setDebouncedValue","useEffect","handler","clearTimeout","useDebounce","handleSelect","add","settings","getToken","searchLocation","b","compare","result","i","j","push","merge","CoordLocation","StopLocation","idx","search","getFirstMatch","allLocations","array","set","Set","itemId","has","removeDuplicates","results","renderResults","Modal","children","el","document","createElement","getElementsByTagName","modalRoot","getElementById","classList","appendChild","remove","removeChild","ReactDOM","createPortal","LocationInput","disabled","selected","overlay","setOverlay","handleCancel","classnames","fakeInput","static","onFocus","SearchBar","searching","onDatetimeChange","onLocationChange","onLocationSwitch","onSearch","inputs","switchLocationsButton","switchLocationsIcon","faExchangeAlt","rotation","datetime","searchButton","spinnerIcon","faSpinner","spin","TripDetails","trip","renderLocation","overview","time","track","Notes","notes","Note","note","index","$","legs","Leg","filter","leg","Origin","direction","Destination","renderLeg","TripOverview","destination","last","renderTime","renderInfoIcon","rtTime","notesIcon","faInfoCircle","invalid","some","sname","style","backgroundColor","fgColor","borderColor","color","bgColor","faArrowRight","travelTime","start","end","startDate","rtDate","endDate","hourDiff","diff","minuteDiff","TripListItem","expanded","setExpanded","TripList","trips","tripIndex","SearchResult","earlierLaterButtons","earlierLaterButton","onShowEarlier","onShowLater","ErrorMessage","error","App","auth","tripsState","setTripsState","originState","setOriginState","destState","setDestState","dateState","setDateState","errorState","setErrorState","nowState","setNowState","searchingState","setSearchingState","handleDatetimeChange","handleLocationChange","Error","handleNowButtonClick","switchLocations","currentDest","handleSearch","parseResponse","parseError","tripList","Trip","parseTrips","findEarlierTrips","newDate","subtract","findLaterTrips","StrictMode","app","navbar","logo","faBus","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","render","URL","process","href","addEventListener","contentType","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.3d484198.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"legs\":\"TripDetails_legs__3EAG4\",\"leg\":\"TripDetails_leg__3RYui\",\"direction\":\"TripDetails_direction__nETYo\",\"track\":\"TripDetails_track__3u51Y\",\"overview\":\"TripDetails_overview__3QAnu\",\"location\":\"TripDetails_location__3weSf\",\"time\":\"TripDetails_time__3LcKt\",\"name\":\"TripDetails_name__3k2bV\",\"notes\":\"TripDetails_notes__2gw9C\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"overview\":\"TripOverview_overview___kW70\",\"origin\":\"TripOverview_origin__1YlZ5\",\"destination\":\"TripOverview_destination__guSIV\",\"invalid\":\"TripOverview_invalid__1q6Bi\",\"notesIcon\":\"TripOverview_notesIcon__1nrtU\",\"legs\":\"TripOverview_legs__1MaC0\",\"travelTime\":\"TripOverview_travelTime__18eQF\",\"leg\":\"TripOverview_leg__15Ba1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"locations\":\"SearchBar_locations__CSxHQ\",\"datetime\":\"SearchBar_datetime__2SP0R\",\"search\":\"SearchBar_search__22_iH\",\"switchLocationsButton\":\"SearchBar_switchLocationsButton__1Gqfa\",\"switchLocationsIcon\":\"SearchBar_switchLocationsIcon__1eBNU\",\"searchButton\":\"SearchBar_searchButton__1GItM\",\"spinnerIcon\":\"SearchBar_spinnerIcon__2MG7m\",\"searching\":\"SearchBar_searching__8o1tj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__1tA9O\",\"navbar\":\"App_navbar__2AN66\",\"logo\":\"App_logo__3qVxm\",\"error\":\"App_error__yS4ld\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"LocationSearchInput_wrapper__2djFY\",\"icon\":\"LocationSearchInput_icon__1yItC\",\"input\":\"LocationSearchInput_input__2QYj6\",\"cancelButton\":\"LocationSearchInput_cancelButton__392il\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"DatetimeInput_wrapper__XqBGi\",\"nowButton\":\"DatetimeInput_nowButton__23SMg\",\"nowOverlay\":\"DatetimeInput_nowOverlay__1vweV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Input_wrapper__2o0fD\",\"input\":\"Input_input__24dvw\",\"inputIcon\":\"Input_inputIcon__3Fr-L\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"LocationInput_wrapper__22Kag\",\"fakeInput\":\"LocationInput_fakeInput__2YPHy\",\"static\":\"LocationInput_static__2Xnyu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"earlierLaterButtons\":\"SearchResult_earlierLaterButtons__2UOOe\",\"earlierLaterButton\":\"SearchResult_earlierLaterButton__15iUV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"search\":\"LocationSearch_search__nxx0-\",\"results\":\"LocationSearch_results__ypv_A\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"address\":\"Location_address__1BjE9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"LocationList_list__1GHD9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"LocationListItem_item__LweBU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"TripList_list__UIk8G\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"TripListItem_item__104lt\"};","import dayjs from \"dayjs\";\r\n\r\nexport interface Trip {\r\n  Leg: Leg[];\r\n}\r\n\r\nexport interface Leg {\r\n  Origin: Location;\r\n  Destination: Location;\r\n  direction: string;\r\n  name: string;\r\n  sname: string;\r\n  fgColor: string;\r\n  bgColor: string;\r\n  type: string;\r\n}\r\n\r\nexport interface Location {\r\n  date: string;\r\n  name: string;\r\n  Notes?: { Note: Note[] };\r\n  rtDate?: string;\r\n  rtTime?: string;\r\n  time: string;\r\n  track?: string;\r\n}\r\n\r\ninterface Note {\r\n  $: string;\r\n  key: string;\r\n  priority: string;\r\n  severity: string;\r\n}\r\n\r\nexport interface CoordLocation {\r\n  id?: string;\r\n  idx?: string;\r\n  lat?: string;\r\n  lon?: string;\r\n  name: string;\r\n}\r\n\r\nexport interface StopLocation extends CoordLocation {\r\n  id: string;\r\n}\r\n\r\nexport async function searchLocation(token: string, searchString: string) {\r\n  const url =\r\n    \"https://api.vasttrafik.se/bin/rest.exe/v2/location.name\" +\r\n    \"?format=json&input=\" +\r\n    encodeURIComponent(searchString);\r\n\r\n  const response = await fetch(url, {\r\n    headers: new Headers({ Authorization: \"Bearer \" + token }),\r\n    method: \"GET\"\r\n  });\r\n  return response.json();\r\n}\r\n\r\nexport async function searchTrip(\r\n  token: string,\r\n  origin: CoordLocation,\r\n  dest: CoordLocation,\r\n  date: Date\r\n) {\r\n  const dateString = dayjs(date).format(\"YYYY-MM-DD\");\r\n  const timeString = dayjs(date).format(\"HH:mm\");\r\n  const url =\r\n    \"https://api.vasttrafik.se/bin/rest.exe/v2/trip?format=json\" +\r\n    getLocationParameter(\"origin\", origin) +\r\n    getLocationParameter(\"dest\", dest) +\r\n    \"&date=\" +\r\n    encodeURIComponent(dateString) +\r\n    \"&time=\" +\r\n    encodeURIComponent(timeString);\r\n\r\n  const response = await fetch(url, {\r\n    headers: new Headers({ Authorization: \"Bearer \" + token }),\r\n    method: \"GET\"\r\n  });\r\n  return response.json();\r\n}\r\n\r\nfunction getLocationParameter(\r\n  inputName: string,\r\n  location: CoordLocation\r\n): string {\r\n  if (location.id) {\r\n    return \"&\" + inputName + \"Id=\" + encodeURIComponent(location.id);\r\n  } else if (location.lat && location.lon) {\r\n    return (\r\n      \"&\" +\r\n      inputName +\r\n      \"CoordName=\" +\r\n      encodeURIComponent(location.name) +\r\n      \"&\" +\r\n      inputName +\r\n      \"CoordLat=\" +\r\n      encodeURIComponent(location.lat) +\r\n      \"&\" +\r\n      inputName +\r\n      \"CoordLong=\" +\r\n      encodeURIComponent(location.lon)\r\n    );\r\n  } else {\r\n    return \"\";\r\n  }\r\n}\r\n","interface AuthToken {\r\n  expiryDate: number;\r\n  token: string;\r\n}\r\n\r\nexport default class Auth {\r\n  private key: string;\r\n  private secret: string;\r\n  private token: AuthToken;\r\n\r\n  constructor(key: string, secret: string) {\r\n    this.key = key;\r\n    this.secret = secret;\r\n    this.token = {\r\n      expiryDate: 0,\r\n      token: \"\"\r\n    };\r\n  }\r\n\r\n  public getToken(): Promise<string> {\r\n    return new Promise<string>((resolve, reject) => {\r\n      const storedToken = this.getStoredToken();\r\n      if (Date.now() < storedToken.expiryDate) {\r\n        resolve(storedToken.token);\r\n      } else {\r\n        this.signIn()\r\n          .then(response => response.json())\r\n          .then(json => {\r\n            this.token = {\r\n              expiryDate: Date.now() + Number(json.expires_in) * 1000,\r\n              token: json.access_token\r\n            };\r\n            this.storeToken();\r\n\r\n            resolve(this.token.token);\r\n          });\r\n      }\r\n    });\r\n  }\r\n\r\n  private getStoredToken(): AuthToken {\r\n    return {\r\n      expiryDate: Number(localStorage.getItem(\"tokenExpiryDate\")),\r\n      token: localStorage.getItem(\"token\") as string\r\n    };\r\n  }\r\n\r\n  private signIn(): Promise<Response> {\r\n    const headers = new Headers({\r\n      Authorization: \"Basic \" + btoa(this.key + \":\" + this.secret),\r\n      \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n    });\r\n\r\n    return fetch(\"https://api.vasttrafik.se:443/token\", {\r\n      body: \"grant_type=client_credentials&scope=\" + this.scope(),\r\n      headers,\r\n      method: \"POST\"\r\n    });\r\n  }\r\n\r\n  private scope(): string {\r\n    let scope = localStorage.getItem(\"scope\");\r\n    if (!scope) {\r\n      scope = this.generateScope();\r\n      localStorage.setItem(\"scope\", scope);\r\n    }\r\n    return scope;\r\n  }\r\n\r\n  private generateScope(): string {\r\n    return Math.random()\r\n      .toString(36)\r\n      .slice(2);\r\n  }\r\n\r\n  private storeToken(): void {\r\n    localStorage.setItem(\"token\", this.token.token);\r\n    localStorage.setItem(\"tokenExpiryDate\", String(this.token.expiryDate));\r\n  }\r\n}\r\n","import { useEffect, useState } from \"react\";\r\n\r\n// https://usehooks.com/\r\nexport function useLocalStorage(key: string, initialValue: any) {\r\n  const [item, setInnerValue] = useState(() =>\r\n    window.localStorage.getItem(key)\r\n      ? JSON.parse(window.localStorage.getItem(key)!)\r\n      : initialValue\r\n  );\r\n\r\n  const setValue = (value: any) => {\r\n    setInnerValue(value);\r\n    window.localStorage.setItem(key, JSON.stringify(value));\r\n  };\r\n\r\n  return [item, setValue];\r\n}\r\n\r\n// https://dev.to/gabe_ragland/debouncing-with-react-hooks-jci\r\nexport default function useDebounce(value: any, delay: number) {\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n\r\n  useEffect(() => {\r\n    const handler = setTimeout(() => {\r\n      setDebouncedValue(value);\r\n    }, delay);\r\n    return () => {\r\n      clearTimeout(handler);\r\n    };\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n}\r\n","export default {\n  key: 'd9k7BQPB7_5nIsjU9d7Y0IkFIqUa',\n  secret: 'Ksgx8WdEnn9gjp9Sqln72WgbQdUa',\n};\n","export function list<T>(object: T): T[] {\r\n  if (!object) {\r\n    return [];\r\n  }\r\n  return Array.isArray(object) ? object : [object];\r\n}\r\n\r\nexport function first<T>(array: T[]): T {\r\n  return array[0];\r\n}\r\n\r\nexport function last<T>(array: T[]): T {\r\n  return array[array.length - 1];\r\n}\r\n\r\nexport function merge<T>(\r\n  a: T[],\r\n  b: T[],\r\n  compare: (e1: T, e2: T) => number\r\n): T[] {\r\n  const result = [];\r\n  let i = 0;\r\n  let j = 0;\r\n  while (i < a.length && j < b.length) {\r\n    result.push(compare(a[i], b[j]) <= 0 ? a[i++] : b[j++]);\r\n  }\r\n  while (i < a.length) {\r\n    result.push(a[i++]);\r\n  }\r\n  while (j < b.length) {\r\n    result.push(b[j++]);\r\n  }\r\n  return result;\r\n}\r\n\r\nexport function removeDuplicates<T>(array: T[], id: (e: T) => string): T[] {\r\n  const result: T[] = [];\r\n  const set = new Set<string>();\r\n  for (const item of array) {\r\n    const itemId = id(item);\r\n    if (!set.has(itemId)) {\r\n      result.push(item);\r\n    }\r\n    set.add(itemId);\r\n  }\r\n  return result;\r\n}\r\n\r\nexport function shortLocation(locationName: string): string {\r\n  return locationName.split(\",\")[0];\r\n}\r\n\r\nexport function padNumber(n: number): string {\r\n  return n < 10 ? \"0\" + n : \"\" + n;\r\n}\r\n","import { IconProp } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport React from \"react\";\r\nimport styles from \"./Input.module.css\";\r\n\r\ninterface Props {\r\n  className?: string;\r\n  icon: IconProp;\r\n  placeholder?: string;\r\n  readOnly?: boolean;\r\n  type: string;\r\n  value: string;\r\n  onChange?(event: React.FormEvent<HTMLInputElement>): any;\r\n  onFocus?(event: React.FocusEvent<HTMLInputElement>): any;\r\n}\r\n\r\nexport const Input = (props: Props) => {\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <FontAwesomeIcon className={styles.inputIcon} icon={props.icon} />\r\n      <input className={styles.input} {...props} />\r\n    </div>\r\n  );\r\n};\r\n","import { faCalendarAlt } from \"@fortawesome/free-solid-svg-icons\";\r\nimport dayjs from \"dayjs\";\r\nimport React from \"react\";\r\nimport styles from \"./DatetimeInput.module.css\";\r\nimport { Input } from \"./Input\";\r\n\r\ninterface Props {\r\n  date: Date;\r\n  now: boolean;\r\n  onChange(date: Date): void;\r\n  onNowButtonClick(): void;\r\n}\r\n\r\nexport const DatetimeInput = ({\r\n  date,\r\n  now,\r\n  onChange,\r\n  onNowButtonClick\r\n}: Props) => {\r\n  const value = dayjs(date).format(\"YYYY-MM-DDTHH:mm:ss\");\r\n\r\n  function renderNowOverlay() {\r\n    return <div className={styles.nowOverlay}>Avgår nu</div>;\r\n  }\r\n\r\n  function renderNowButton() {\r\n    return (\r\n      <button className={styles.nowButton} onClick={onNowButtonClick}>\r\n        Nu\r\n      </button>\r\n    );\r\n  }\r\n\r\n  function handleChange(event: React.FormEvent<HTMLInputElement>) {\r\n    const target = event.target as HTMLInputElement;\r\n    onChange(dayjs(target.value).toDate());\r\n  }\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <Input\r\n        icon={faCalendarAlt}\r\n        type=\"datetime-local\"\r\n        value={value}\r\n        onChange={handleChange}\r\n      />\r\n      {now ? renderNowOverlay() : renderNowButton()}\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./Location.module.css\";\r\n\r\ninterface Props {\r\n  name: string;\r\n}\r\n\r\nexport const Location = ({ name }: Props) => {\r\n  const [station, address] = name.split(\", \");\r\n  return (\r\n    <div>\r\n      <div>{station}</div>\r\n      {address && <div className={styles.address}>{address}</div>}\r\n    </div>\r\n  );\r\n};\r\n","interface CacheItem {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\nexport default class MruCache<T extends CacheItem> {\r\n  private items: T[];\r\n  private limit: number;\r\n\r\n  constructor(limit: number) {\r\n    this.limit = limit;\r\n\r\n    const mru = localStorage.getItem(\"mru\");\r\n    this.items = mru ? JSON.parse(mru) : [];\r\n  }\r\n\r\n  public add(item: T): void {\r\n    this.removeExistingItem(item);\r\n    this.items.unshift(item);\r\n    this.ensureLengthWithinLimit();\r\n    this.setMostRecentlyUsed();\r\n  }\r\n\r\n  public getMostRecentlyUsed(): T[] {\r\n    return this.items;\r\n  }\r\n\r\n  public setMostRecentlyUsed(): void {\r\n    localStorage.setItem(\"mru\", JSON.stringify(this.items));\r\n  }\r\n\r\n  public getFirstMatch(searchString: string): T | undefined {\r\n    return this.items.find(item =>\r\n      item.name.toLowerCase().startsWith(searchString.toLowerCase())\r\n    );\r\n  }\r\n\r\n  private removeExistingItem(item: T): void {\r\n    const existingIndex = this.items.findIndex(\r\n      existingItem => existingItem.id === item.id\r\n    );\r\n    if (existingIndex > -1) {\r\n      this.items.splice(existingIndex, 1);\r\n    }\r\n  }\r\n\r\n  private ensureLengthWithinLimit(): void {\r\n    if (this.items.length > this.limit) {\r\n      this.items.splice(this.limit, this.items.length - this.limit);\r\n    }\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport { CoordLocation } from \"../api\";\r\nimport { Location } from \"./Location\";\r\nimport styles from \"./LocationListItem.module.css\";\r\n\r\ninterface Props {\r\n  location: CoordLocation;\r\n  onClick(location: CoordLocation): any;\r\n}\r\n\r\nexport const LocationListItem = ({ location, onClick }: Props) => {\r\n  function handleClick(event: React.MouseEvent<HTMLElement>) {\r\n    event.stopPropagation();\r\n    onClick(location);\r\n  }\r\n\r\n  return (\r\n    <li className={styles.item} onClick={handleClick}>\r\n      <Location name={location.name} />\r\n    </li>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { CoordLocation } from \"../api\";\r\nimport styles from \"./LocationList.module.css\";\r\nimport { LocationListItem } from \"./LocationListItem\";\r\n\r\ninterface Props {\r\n  locations: CoordLocation[];\r\n  onSelect(location: CoordLocation): any;\r\n}\r\n\r\nexport const LocationList = ({ locations, onSelect }: Props) => {\r\n  return (\r\n    <ul className={styles.list}>\r\n      {locations.map(location => (\r\n        <LocationListItem\r\n          location={location}\r\n          key={location.id || location.name}\r\n          onClick={onSelect}\r\n        />\r\n      ))}\r\n    </ul>\r\n  );\r\n};\r\n","import { faMapMarkerAlt } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport React from \"react\";\r\nimport styles from \"./LocationSearchInput.module.css\";\r\n\r\ninterface Props {\r\n  value: string;\r\n  onChange(event: React.FormEvent<HTMLInputElement>): void;\r\n  onCancel(event: React.MouseEvent<HTMLElement>): void;\r\n}\r\n\r\nexport const LocationSearchInput = ({ value, onChange, onCancel }: Props) => {\r\n  function focusInput(input: HTMLInputElement) {\r\n    setTimeout(() => {\r\n      if (input) {\r\n        input.focus();\r\n      }\r\n    }, 0);\r\n  }\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <div className={styles.icon}>\r\n        <FontAwesomeIcon icon={faMapMarkerAlt} />\r\n      </div>\r\n      <input\r\n        className={styles.input}\r\n        placeholder=\"Station\"\r\n        ref={focusInput}\r\n        type=\"text\"\r\n        value={value}\r\n        onChange={onChange}\r\n      />\r\n      <button className={styles.cancelButton} onClick={onCancel}>\r\n        Avbryt\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { CoordLocation, searchLocation, StopLocation } from \"../api\";\r\nimport Auth from \"../Auth\";\r\nimport useDebounce from \"../hooks\";\r\nimport MruCache from \"../MruCache\";\r\nimport settings from \"../settings\";\r\nimport { list, merge, removeDuplicates } from \"../util\";\r\nimport { LocationList } from \"./LocationList\";\r\nimport styles from \"./LocationSearch.module.css\";\r\nimport { LocationSearchInput } from \"./LocationSearchInput\";\r\n\r\ninterface Props {\r\n  onCancel(): void;\r\n  onSelect(location: CoordLocation): void;\r\n}\r\n\r\nexport const LocationSearch = ({ onCancel, onSelect }: Props) => {\r\n  const recentLocations: MruCache<StopLocation> = new MruCache(10);\r\n\r\n  const [locationState, setLocationState] = useState<CoordLocation[]>(\r\n    recentLocations.getMostRecentlyUsed()\r\n  );\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [quickLocation, setQuickLocation] = useState<\r\n    CoordLocation | undefined\r\n  >();\r\n\r\n  const debouncedSearchValue = useDebounce(searchValue, 250);\r\n\r\n  useEffect(() => {\r\n    if (!debouncedSearchValue) {\r\n      return;\r\n    }\r\n\r\n    new Auth(settings.key, settings.secret).getToken().then(token => {\r\n      searchLocation(token, debouncedSearchValue).then(response => {\r\n        const coordLocations = list(response.LocationList.CoordLocation);\r\n        const stopLocations = list(response.LocationList.StopLocation);\r\n        const locations = merge(\r\n          coordLocations,\r\n          stopLocations,\r\n          (a: CoordLocation, b: CoordLocation) => Number(a.idx) - Number(b.idx)\r\n        );\r\n        setLocationState(locations);\r\n      });\r\n    });\r\n  }, [debouncedSearchValue]);\r\n\r\n  function renderResults() {\r\n    if (!locationState.length && !quickLocation) {\r\n      return null;\r\n    }\r\n\r\n    const allLocations: CoordLocation[] = quickLocation\r\n      ? removeDuplicates(\r\n          [quickLocation, ...locationState],\r\n          location => location.id || location.name\r\n        )\r\n      : locationState;\r\n\r\n    return (\r\n      <div className={styles.results}>\r\n        <LocationList locations={allLocations} onSelect={handleSelect} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  function handleChange(event: React.FormEvent<HTMLInputElement>) {\r\n    const target = event.target as HTMLInputElement;\r\n    const value = target.value;\r\n\r\n    setSearchValue(value);\r\n    setQuickLocation(recentLocations.getFirstMatch(value));\r\n\r\n    if (!value) {\r\n      showMostRecentlyUsed();\r\n    }\r\n  }\r\n\r\n  function showMostRecentlyUsed() {\r\n    setLocationState(recentLocations.getMostRecentlyUsed());\r\n  }\r\n\r\n  function handleCancel(event: React.MouseEvent<HTMLElement>) {\r\n    event.stopPropagation();\r\n    onCancel();\r\n  }\r\n\r\n  function handleSelect(location: CoordLocation) {\r\n    onSelect(location);\r\n    if (location.id) {\r\n      recentLocations.add(location as StopLocation);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={styles.search}>\r\n      <LocationSearchInput\r\n        value={searchValue}\r\n        onChange={handleChange}\r\n        onCancel={handleCancel}\r\n      />\r\n      {renderResults()}\r\n    </div>\r\n  );\r\n};\r\n","import { useEffect } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./Modal.css\";\r\n\r\nexport const Modal = ({ children }: any) => {\r\n  const el: HTMLDivElement = document.createElement(\"div\");\r\n\r\n  useEffect(() => {\r\n    const body = document.getElementsByTagName(\"body\")[0] as HTMLBodyElement;\r\n    const modalRoot = document.getElementById(\"modal-root\") as HTMLDivElement;\r\n\r\n    body.classList.add(\"noscroll\");\r\n    el.classList.add(\"modal\");\r\n    modalRoot.appendChild(el);\r\n\r\n    return () => {\r\n      body.classList.remove(\"noscroll\");\r\n      modalRoot.removeChild(el);\r\n    };\r\n  }, [el]);\r\n\r\n  return ReactDOM.createPortal(children, el);\r\n};\r\n","import classnames from \"classnames\";\r\nimport React, { useState } from \"react\";\r\nimport { CoordLocation } from \"../api\";\r\nimport { Location } from \"./Location\";\r\nimport styles from \"./LocationInput.module.css\";\r\nimport { LocationSearch } from \"./LocationSearch\";\r\nimport { Modal } from \"./Modal\";\r\n\r\ninterface Props {\r\n  disabled: boolean;\r\n  selected: CoordLocation;\r\n  onSelect(location: CoordLocation): any;\r\n}\r\n\r\nexport const LocationInput = ({ disabled, selected, onSelect }: Props) => {\r\n  const [overlay, setOverlay] = useState(false);\r\n  const name = selected.name;\r\n\r\n  function renderOverlay() {\r\n    return (\r\n      <Modal>\r\n        <LocationSearch onCancel={handleCancel} onSelect={handleSelect} />\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  function handleFocus() {\r\n    setOverlay(true && !disabled);\r\n  }\r\n\r\n  function handleCancel() {\r\n    setOverlay(false);\r\n  }\r\n\r\n  function handleSelect(location: CoordLocation) {\r\n    setOverlay(false);\r\n    onSelect(location);\r\n  }\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      {overlay && renderOverlay()}\r\n      {name && <Location name={name} />}\r\n      <input\r\n        type=\"text\"\r\n        className={classnames(styles.fakeInput, { [styles.static]: !name })}\r\n        onFocus={handleFocus}\r\n        placeholder={!name ? \"Hållplats\" : \"\"}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import { faExchangeAlt, faSpinner } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport classnames from \"classnames\";\r\nimport React from \"react\";\r\nimport { CoordLocation } from \"../api\";\r\nimport { DatetimeInput } from \"./DatetimeInput\";\r\nimport { LocationInput } from \"./LocationInput\";\r\nimport styles from \"./SearchBar.module.css\";\r\n\r\ninterface Props {\r\n  origin: CoordLocation;\r\n  dest: CoordLocation;\r\n  date: Date;\r\n  now: boolean;\r\n  searching: boolean;\r\n  onDatetimeChange(date: Date): any;\r\n  onLocationChange(inputName: string, location: CoordLocation): any;\r\n  onLocationSwitch(): any;\r\n  onNowButtonClick(): void;\r\n  onSearch(): any;\r\n}\r\n\r\nexport const SearchBar = ({\r\n  origin,\r\n  dest,\r\n  date,\r\n  now,\r\n  searching,\r\n  onDatetimeChange,\r\n  onLocationChange,\r\n  onLocationSwitch,\r\n  onNowButtonClick,\r\n  onSearch\r\n}: Props) => {\r\n  function onOriginSelected(location: CoordLocation) {\r\n    onLocationChange(\"origin\", location);\r\n  }\r\n\r\n  function onDestinationSelected(location: CoordLocation) {\r\n    onLocationChange(\"dest\", location);\r\n  }\r\n\r\n  function search() {\r\n    onSearch();\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className={styles.locations}>\r\n        <div className={styles.inputs}>\r\n          <LocationInput\r\n            disabled={searching}\r\n            selected={origin}\r\n            onSelect={onOriginSelected}\r\n          />\r\n          <LocationInput\r\n            disabled={searching}\r\n            selected={dest}\r\n            onSelect={onDestinationSelected}\r\n          />\r\n        </div>\r\n        <button\r\n          className={styles.switchLocationsButton}\r\n          onClick={onLocationSwitch}\r\n        >\r\n          <FontAwesomeIcon\r\n            className={styles.switchLocationsIcon}\r\n            icon={faExchangeAlt}\r\n            rotation={90}\r\n          />\r\n        </button>\r\n      </div>\r\n      <div className={styles.datetime}>\r\n        <DatetimeInput\r\n          date={date}\r\n          now={now}\r\n          onChange={onDatetimeChange}\r\n          onNowButtonClick={onNowButtonClick}\r\n        />\r\n      </div>\r\n      <button\r\n        className={styles.searchButton}\r\n        onClick={search}\r\n        disabled={searching}\r\n      >\r\n        {searching ? (\r\n          <span>\r\n            Söker...\r\n            <FontAwesomeIcon\r\n              className={classnames(styles.spinnerIcon, \"right-icon\")}\r\n              icon={faSpinner}\r\n              spin={true}\r\n            />\r\n          </span>\r\n        ) : (\r\n          <span>Sök resa</span>\r\n        )}\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Leg, Location, Trip } from \"../api\";\r\nimport styles from \"./TripDetails.module.css\";\r\n\r\ninterface Props {\r\n  trip: Trip;\r\n}\r\n\r\nexport const TripDetails = ({ trip }: Props) => {\r\n  function renderLegs() {\r\n    return trip.Leg.filter(leg => leg.type !== \"WALK\").map((leg, index) =>\r\n      renderLeg(leg, index)\r\n    );\r\n  }\r\n\r\n  function renderLeg(leg: Leg, index: number) {\r\n    return (\r\n      <li className={styles.leg} key={index}>\r\n        {renderLocation(leg.Origin)}\r\n        <div className={styles.direction}>\r\n          {leg.name} mot {leg.direction}\r\n        </div>\r\n        {renderLocation(leg.Destination)}\r\n      </li>\r\n    );\r\n  }\r\n\r\n  function renderLocation(location: Location) {\r\n    return (\r\n      <div className={styles.location}>\r\n        <div className={styles.overview}>\r\n          <div className={styles.time}>{location.time}</div>\r\n          <div className={styles.name}>{location.name}</div>\r\n          <div className={styles.track}>\r\n            {location.track && \"Läge \" + location.track}\r\n          </div>\r\n        </div>\r\n        {location.Notes && (\r\n          <ul className={styles.notes}>\r\n            {location.Notes.Note.map((note, index) => (\r\n              <li key={index}>{note.$}</li>\r\n            ))}\r\n          </ul>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return <ul className={styles.legs}>{renderLegs()}</ul>;\r\n};\r\n","import { faArrowRight, faInfoCircle } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport classnames from \"classnames\";\r\nimport dayjs from \"dayjs\";\r\nimport React from \"react\";\r\nimport { Leg, Location, Trip } from \"../api\";\r\nimport { first, last, padNumber } from \"../util\";\r\nimport styles from \"./TripOverview.module.css\";\r\n\r\ninterface Props {\r\n  trip: Trip;\r\n  onClick(): void;\r\n}\r\n\r\nexport const TripOverview = ({ trip, onClick }: Props) => {\r\n  const origin = first(trip.Leg).Origin;\r\n  const destination = last(trip.Leg).Destination;\r\n\r\n  function renderTime(location: Location, renderInfoIcon = false) {\r\n    return [\r\n      <span key={0}>\r\n        {location.rtTime ?? location.time}\r\n        {renderInfoIcon && (\r\n          <FontAwesomeIcon\r\n            className={classnames(styles.notesIcon, \"right-icon\")}\r\n            icon={faInfoCircle}\r\n          />\r\n        )}\r\n      </span>,\r\n      location.rtTime && location.time !== location.rtTime && (\r\n        <s className={classnames(styles.time, styles.invalid)} key={1}>\r\n          {location.time}\r\n        </s>\r\n      )\r\n    ];\r\n  }\r\n\r\n  function renderLegs() {\r\n    return trip.Leg.filter(leg => leg.sname).map((leg, index) =>\r\n      renderLeg(leg, index)\r\n    );\r\n  }\r\n\r\n  function renderLeg(leg: Leg, index: number) {\r\n    return (\r\n      <span\r\n        className={styles.leg}\r\n        key={index}\r\n        style={{\r\n          backgroundColor: leg.fgColor,\r\n          borderColor: leg.fgColor === \"#ffffff\" ? \"#EE1844\" : \"transparent\",\r\n          color: leg.bgColor\r\n        }}\r\n      >\r\n        {leg.sname}\r\n      </span>\r\n    );\r\n  }\r\n\r\n  function travelTime(start: Location, end: Location) {\r\n    const startDate = dayjs(\r\n      `${start.rtDate || start.date} ${start.rtTime || start.time}`\r\n    );\r\n    const endDate = dayjs(\r\n      `${end.rtDate || end.date} ${end.rtTime || end.time}`\r\n    );\r\n    const hourDiff = endDate.diff(startDate, \"hour\");\r\n    const minuteDiff = endDate.diff(startDate, \"minute\") % 60;\r\n    return padNumber(hourDiff) + \":\" + padNumber(minuteDiff);\r\n  }\r\n\r\n  function showInfoIcon() {\r\n    return trip.Leg.some(leg => leg.Origin.Notes || leg.Destination.Notes);\r\n  }\r\n\r\n  return (\r\n    <div className={styles.overview} onClick={onClick}>\r\n      <div className={styles.origin}>\r\n        <div>{renderTime(origin, showInfoIcon())}</div>\r\n        <div className={styles.legs}>{renderLegs()}</div>\r\n      </div>\r\n      <FontAwesomeIcon icon={faArrowRight} />\r\n      <div className={styles.destination}>\r\n        <div>{renderTime(destination)}</div>\r\n        <div className={styles.travelTime}>\r\n          Restid: {travelTime(origin, destination)}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { Trip } from \"../api\";\r\nimport { TripDetails } from \"./TripDetails\";\r\nimport styles from \"./TripListItem.module.css\";\r\nimport { TripOverview } from \"./TripOverview\";\r\n\r\ninterface Props {\r\n  trip: Trip;\r\n}\r\n\r\nexport const TripListItem = ({ trip }: Props) => {\r\n  const [expanded, setExpanded] = useState(false);\r\n\r\n  function handleClick() {\r\n    setExpanded(!expanded);\r\n  }\r\n\r\n  return (\r\n    <div className={styles.item}>\r\n      <TripOverview trip={trip} onClick={handleClick} />\r\n      {expanded && <TripDetails trip={trip} />}\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Trip } from \"../api\";\r\nimport styles from \"./TripList.module.css\";\r\nimport { TripListItem } from \"./TripListItem\";\r\n\r\ninterface Props {\r\n  trips: Trip[];\r\n}\r\n\r\nexport const TripList = ({ trips }: Props) => {\r\n  return (\r\n    <ul className={styles.list}>\r\n      {trips.map((trip, tripIndex) => (\r\n        <li key={tripIndex}>\r\n          <TripListItem trip={trip} />\r\n        </li>\r\n      ))}\r\n    </ul>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Trip } from \"../api\";\r\nimport styles from \"./SearchResult.module.css\";\r\nimport { TripList } from \"./TripList\";\r\n\r\ninterface Props {\r\n  trips: Trip[];\r\n  onShowEarlier(): void;\r\n  onShowLater(): void;\r\n}\r\n\r\nexport const SearchResult = (props: Props) => {\r\n  return (\r\n    <div>\r\n      <TripList trips={props.trips} />\r\n      <div className={styles.earlierLaterButtons}>\r\n        <button\r\n          className={styles.earlierLaterButton}\r\n          onClick={props.onShowEarlier}\r\n        >\r\n          Tidigare\r\n        </button>\r\n        <button\r\n          className={styles.earlierLaterButton}\r\n          onClick={props.onShowLater}\r\n        >\r\n          Senare\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import { faBus } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport dayjs from \"dayjs\";\r\nimport React, { useState } from \"react\";\r\nimport { CoordLocation, searchTrip } from \"../api\";\r\nimport Auth from \"../Auth\";\r\nimport { useLocalStorage } from \"../hooks\";\r\nimport settings from \"../settings\";\r\nimport { list } from \"../util\";\r\nimport styles from \"./App.module.css\";\r\nimport { SearchBar } from \"./SearchBar\";\r\nimport { SearchResult } from \"./SearchResult\";\r\n\r\nconst ErrorMessage = (props: { error: string }) => (\r\n  <div className={styles.error}>{props.error}</div>\r\n);\r\n\r\nconst App: React.FC = () => {\r\n  const auth: Auth = new Auth(settings.key, settings.secret);\r\n\r\n  const [tripsState, setTripsState] = useLocalStorage(\"trips\", []);\r\n  const [originState, setOriginState] = useLocalStorage(\"origin\", { name: \"\" });\r\n  const [destState, setDestState] = useLocalStorage(\"dest\", { name: \"\" });\r\n\r\n  const [dateState, setDateState] = useState(new Date());\r\n  const [errorState, setErrorState] = useState(\"\");\r\n  const [nowState, setNowState] = useState(true);\r\n  const [searchingState, setSearchingState] = useState(false);\r\n\r\n  function handleNavBarClick() {\r\n    setErrorState(\"\");\r\n    setTripsState([]);\r\n  }\r\n\r\n  function renderMainContent() {\r\n    if (errorState) {\r\n      return <ErrorMessage error={errorState} />;\r\n    } else if (tripsState.length) {\r\n      return renderSearchResult();\r\n    } else {\r\n      return renderSearchBar();\r\n    }\r\n  }\r\n\r\n  function renderSearchBar() {\r\n    return (\r\n      <SearchBar\r\n        origin={originState}\r\n        dest={destState}\r\n        date={dateState}\r\n        now={nowState}\r\n        searching={searchingState}\r\n        onDatetimeChange={handleDatetimeChange}\r\n        onLocationChange={handleLocationChange}\r\n        onLocationSwitch={switchLocations}\r\n        onNowButtonClick={handleNowButtonClick}\r\n        onSearch={handleSearch}\r\n      />\r\n    );\r\n  }\r\n\r\n  function renderSearchResult() {\r\n    return (\r\n      <SearchResult\r\n        trips={tripsState}\r\n        onShowEarlier={findEarlierTrips}\r\n        onShowLater={findLaterTrips}\r\n      />\r\n    );\r\n  }\r\n\r\n  function handleDatetimeChange(date: Date) {\r\n    setDateState(date);\r\n    setNowState(false);\r\n  }\r\n\r\n  function handleLocationChange(inputName: string, location: CoordLocation) {\r\n    switch (inputName) {\r\n      case \"dest\":\r\n        setDestState(location);\r\n        break;\r\n      case \"origin\":\r\n        setOriginState(location);\r\n        break;\r\n      default:\r\n        throw new Error(\"Unknown input name: \" + inputName);\r\n    }\r\n  }\r\n\r\n  function handleNowButtonClick() {\r\n    setNowState(true);\r\n  }\r\n\r\n  function switchLocations() {\r\n    const currentDest = destState;\r\n\r\n    setDestState(originState);\r\n    setOriginState(currentDest);\r\n  }\r\n\r\n  function handleSearch() {\r\n    let date = dateState;\r\n\r\n    if (nowState) {\r\n      date = new Date();\r\n      setDateState(date);\r\n    }\r\n\r\n    search(date);\r\n  }\r\n\r\n  async function search(date?: Date) {\r\n    date = date || dateState;\r\n\r\n    setErrorState(\"\");\r\n    setSearchingState(true);\r\n    setTripsState([]);\r\n\r\n    try {\r\n      const token = await auth.getToken();\r\n      parseResponse(await searchTrip(token, originState, destState, date));\r\n    } catch {\r\n      parseError(\"Någonting gick snett.\");\r\n    }\r\n  }\r\n\r\n  function parseResponse(response: any): void {\r\n    const tripList = response.TripList;\r\n    if (tripList.error) {\r\n      parseError(\"Inga resultat funna.\");\r\n    } else {\r\n      parseTrips(tripList);\r\n    }\r\n  }\r\n\r\n  function parseError(error: string): void {\r\n    setErrorState(error);\r\n    setSearchingState(false);\r\n  }\r\n\r\n  function parseTrips(tripList: any): void {\r\n    const trips = list(tripList.Trip);\r\n\r\n    for (const trip of trips) {\r\n      trip.Leg = list(trip.Leg);\r\n      for (const leg of trip.Leg) {\r\n        if (leg.Origin.Notes) {\r\n          leg.Origin.Notes.Note = list(leg.Origin.Notes.Note);\r\n        }\r\n        if (leg.Destination.Notes) {\r\n          leg.Destination.Notes.Note = list(leg.Destination.Notes.Note);\r\n        }\r\n      }\r\n    }\r\n\r\n    setSearchingState(false);\r\n    setTripsState(trips);\r\n  }\r\n\r\n  function findEarlierTrips() {\r\n    const newDate = dayjs(dateState)\r\n      .subtract(20, \"minute\")\r\n      .toDate();\r\n    setDateState(newDate);\r\n    search(newDate);\r\n  }\r\n\r\n  function findLaterTrips() {\r\n    const newDate = dayjs(dateState)\r\n      .add(20, \"minute\")\r\n      .toDate();\r\n    setDateState(newDate);\r\n    search(newDate);\r\n  }\r\n\r\n  return (\r\n    <React.StrictMode>\r\n      <div className={styles.app}>\r\n        <nav className={styles.navbar}>\r\n          <button onClick={handleNavBarClick}>\r\n            <FontAwesomeIcon className={styles.logo} icon={faBus} />\r\n            Reaktiv Västtrafik\r\n          </button>\r\n        </nav>\r\n        {renderMainContent()}\r\n      </div>\r\n    </React.StrictMode>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      process.env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./components/App\";\r\nimport \"./index.css\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"app-root\"));\r\n\r\nserviceWorker.register();\r\n"],"sourceRoot":""}